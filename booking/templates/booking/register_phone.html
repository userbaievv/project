{% extends "booking/base.html" %}
{% block title %}Регистрация через телефон{% endblock %}

{% block content %}
<div class="card mx-auto mt-4" style="max-width: 500px;">
    <div class="card-body">
        <h4 class="card-title text-center mb-4">Регистрация через номер телефона</h4>

        {% if error %}
            <div class="alert alert-danger text-center">{{ error }}</div>
        {% endif %}

        <form method="post" id="phone-registration-form">
            {% csrf_token %}

            <div class="mb-3">
                <label for="phone" class="form-label">Номер телефона</label>
                <input
                    type="text"
                    id="phone"
                    name="phone"
                    class="form-control"
                    placeholder="+7XXXXXXXXXX"
                    required
                >
                <small class="form-text text-muted">Введите номер в формате +7XXXXXXXXXX</small>
            </div>

            <div class="mb-3">
                <label for="username" class="form-label">Имя пользователя</label>
                <input
                    type="text"
                    id="username"
                    name="username"
                    class="form-control"
                    placeholder="Введите имя пользователя"
                    required
                >
                <small class="form-text text-muted">Только буквы, цифры и @/./+/-/_</small>
            </div>

            <div class="mb-3">
                <label for="password" class="form-label">Пароль</label>
                <input
                    type="password"
                    id="password"
                    name="password"
                    class="form-control"
                    required
                >
            </div>

            <div class="mb-3">
                <label for="confirm_password" class="form-label">Подтверждение пароля</label>
                <input
                    type="password"
                    id="confirm_password"
                    name="confirm_password"
                    class="form-control"
                    required
                >
            </div>

            <button type="submit" id="submit-btn" class="btn btn-primary w-100">Зарегистрироваться</button>
        </form>
    </div>
</div>

<script>
document.addEventListener("DOMContentLoaded", function () {
    const phoneInput = document.getElementById("phone");
    const submitBtn = document.getElementById("submit-btn");

    function validatePhone() {
        const phone = phoneInput.value.trim();
        const regex = /^\+7\d{10}$/;
        submitBtn.disabled = !regex.test(phone);
    }

    phoneInput.addEventListener("input", validatePhone);
    validatePhone();
});
</script>
{% endblock %}
